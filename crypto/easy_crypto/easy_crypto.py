from secret import flag
import random
from Crypto.Util.number import *

pt = int(flag.encode('hex'),16)
p = getPrime(2048)
q = getPrime(1024)
n = p*q
e = 3 # just save time
d = inverse(e, (p-1)*(q-1))
d0 = d&((2**800)-1)
assert pt < n

print 'e:',e
print 'partial d:', d0
print 'n:',n
print 'ct:',pow(pt,e,n)

#e: 3
#partial d: 1
#n: 2333213551111419528119976503785686567161109836159361896490669798295538455404003419373195693880193950125815979488300295403091123305475537268521385036974263395844630321193114735883091647229455935840631249600221804111990915147272947074470587167340369845800749486952880641244118039836317255093953403969202588690405194976316194178748361806924568147861151165191682920007674237796434360217655447625595441843774158541359110097857268583911321136019295882974197996338374518448092192943911220197168190239799377351233681891514489152164895854084571373842818347519448837833513269813573096991008783929206576686868745312298775194503075777205612909295262149082466703873489873222965507083913287098103448238271023748799658831078762289159314694342531713683551302295107906321517074853348554840890720115172883252274353084038551648540698037440860011227673256754561366116948820073023167085986450647420641529114582236576855012243141304728685947818061
#ct: 315723391463118032488018158076604414510723246392820714350471166167315793101129645329417171500176579239046271365905866797972178338019591751217565144048515173894443502095345635838053

